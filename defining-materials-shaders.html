<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>shiny: Defining materials and shaders</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">shiny
   &#160;<span id="projectnumber">0.4</span>
   </div>
   <div id="projectbrief">a shader and material management library for OGRE</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Defining materials and shaders </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="first-material"></a>
Your first material</h1>
<p>Create a file called "myFirstMaterial.mat" and place it in the path you have used in your initialisation code (see <a class="el" href="getting-started.html">Getting started</a>). Paste the following:</p>
<div class="fragment"><div class="line">material my_first_material</div><div class="line">{</div><div class="line">        diffuse 1.0 1.0 1.0 1.0</div><div class="line">        specular 0.4 0.4 0.4 32</div><div class="line">        ambient 1.0 1.0 1.0</div><div class="line">        emissive 0.0 0.0 0.0</div><div class="line">        diffuseMap black.png</div><div class="line"></div><div class="line">        pass</div><div class="line">        {</div><div class="line">                diffuse $diffuse</div><div class="line">                specular $specular</div><div class="line">                ambient $ambient</div><div class="line">                emissive $emissive</div><div class="line">                </div><div class="line">                texture_unit diffuseMap</div><div class="line">                {</div><div class="line">                        texture $diffuseMap</div><div class="line">                        create_in_ffp <span class="keyword">true</span> <span class="comment">// use this texture unit for fixed function pipeline </span></div><div class="line">                }</div><div class="line">        }</div><div class="line">}</div><div class="line"></div><div class="line">material material1</div><div class="line">{</div><div class="line">        parent my_first_material</div><div class="line">        diffuseMap texture1.png</div><div class="line">}</div><div class="line"></div><div class="line">material material2</div><div class="line">{</div><div class="line">        parent my_first_material</div><div class="line">        diffuseMap texture2.png</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="first-shader"></a>
The first shader</h1>
<p>Change the 'pass' section to include some shaders:</p>
<div class="fragment"><div class="line">pass</div><div class="line">{</div><div class="line">        vertex_program my_first_shader_vertex</div><div class="line">        fragment_program my_first_shader_fragment</div><div class="line">        ...</div><div class="line">}</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This does <em>not</em> refer to a single shader with a fixed source code, but in fact will automatically create a new <em>instance</em> of this shader (if necessary), which can have its own uniform variables, compile-time macros and much more!</dd></dl>
<p>Next, we're going to define our shaders. Paste this in a new file called 'myfirstshader.shaderset'</p>
<div class="fragment"><div class="line">shader_set my_first_shader_vertex</div><div class="line">{</div><div class="line">        source example.shader</div><div class="line">        <a class="codeRef" doxygen="/usr/local/share/doc/OGRE/api/Ogre.tag:https://ogrecave.github.io/ogre/api/latest/" href="https://ogrecave.github.io/ogre/api/latest/group___hlms.html#gaad5796ba7a933c51ea7370751a2c3519">type</a> vertex</div><div class="line">        profiles_cg vs_2_0 arbvp1</div><div class="line">        profiles_hlsl vs_2_0</div><div class="line">}</div><div class="line"></div><div class="line">shader_set my_first_shader_fragment</div><div class="line">{</div><div class="line">        source example.shader</div><div class="line">        <a class="codeRef" doxygen="/usr/local/share/doc/OGRE/api/Ogre.tag:https://ogrecave.github.io/ogre/api/latest/" href="https://ogrecave.github.io/ogre/api/latest/group___hlms.html#gaad5796ba7a933c51ea7370751a2c3519">type</a> fragment</div><div class="line">        profiles_cg ps_2_x ps_2_0 ps arbfp1</div><div class="line">        profiles_hlsl ps_2_0</div><div class="line">}</div></div><!-- fragment --><p>Some notes:</p><ul>
<li>There is no entry_point property because the entry point is always <em>main</em>.</li>
<li>Both profiles_cg and profiles_hlsl are a list of shader profiles. The first profile that is supported is automatically picked. GLSL does not have shader profiles.</li>
</ul>
<p>Now, let's get into writing our shader! As you can guess from above, the filename should be 'example.shader'. Make sure to also copy the 'core.h' file to the same location. It is included in shiny's source tree under 'Extra/'.</p>
<p>Important: a newline at the end of the file is <b>required</b>. Many editors do this automatically or can be configured to do so. If there is no newline at the end of the file, and the last line is '#endif', you will get the rather cryptic error message " ill formed preprocessor directive: #endif" from boost::wave.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;core.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef SH_VERTEX_SHADER</span></div><div class="line"></div><div class="line">SH_BEGIN_PROGRAM</div><div class="line">        shUniform(float4x4, wvp) @shAutoConstant(wvp, worldviewproj_matrix)</div><div class="line">        shVertexInput(float2, uv0)</div><div class="line">        shOutput(float2, UV)</div><div class="line">SH_START_PROGRAM</div><div class="line">{</div><div class="line">        shOutputPosition = shMatrixMult(wvp, shInputPosition);</div><div class="line">        UV = uv0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#else</span></div><div class="line"></div><div class="line">SH_BEGIN_PROGRAM</div><div class="line">    <span class="comment">// NOTE: It is important that the sampler name here (diffuseMap) matches</span></div><div class="line">    <span class="comment">// the name of the texture unit in the material. This is necessary because the system</span></div><div class="line">    <span class="comment">// skips texture units that are never &quot;referenced&quot; in the shader. This can be the case</span></div><div class="line">    <span class="comment">// when your base material has optional assets (for example a normal map) that are not</span></div><div class="line">    <span class="comment">// used by some derived materials.</span></div><div class="line">        shSampler2D(diffuseMap)</div><div class="line">        shInput(float2, UV)</div><div class="line">SH_START_PROGRAM</div><div class="line">{</div><div class="line">        shOutputColour(0) = shSample(diffuseMap, UV);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>There you have it! This shader will compile in several languages thanks to the porting defines in "core.h". If you need more defines, feel free to add them and don't forget to send them to me!</p>
<p>For a full list of macros available when writing your shaders, refer to the page <a class="el" href="macros.html">Shader Macros</a></p>
<p>In the future, some more in-depth shader examples might follow. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
